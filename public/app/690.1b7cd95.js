"use strict";(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[690],{7229:function(e,s,i){i.r(s),i.d(s,{default:function(){return C}});var a=i(5893),n=i(7294),t=i(1570),d=i(57),r=i(9972),l=i(88),c=i(6703),o=i(2065),v=i(8848),j=i(9147),m=i(7894),h=i(786),x=i(550);const p=h.Z.div`
  width: 48%;
  margin: 7px;

  ${x.Qj(x.Uo.lg)} {
    width: 98%;
  }
`;var g=e=>{const{player:s}=e,i=`${blessing.base_url}/avatar/player/${s.name}`,n=`${i}?png`;return(0,a.jsxs)(p,Object.assign({className:"info-box"},{children:[(0,a.jsx)("div",Object.assign({className:"info-box-icon"},{children:(0,a.jsxs)("picture",{children:[(0,a.jsx)("source",{srcSet:i,type:"image/webp"},void 0),(0,a.jsx)("img",{className:"bs-avatar",src:n},void 0)]},void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:"info-box-content"},{children:[(0,a.jsxs)("div",Object.assign({className:"row"},{children:[(0,a.jsx)("div",Object.assign({className:"col-10"},{children:(0,a.jsx)("b",{children:s.name},void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:"col-2"},{children:(0,a.jsxs)("div",Object.assign({className:"float-right dropdown"},{children:[(0,a.jsx)("a",Object.assign({className:"text-gray",href:"#","data-toggle":"dropdown","aria-expanded":"false"},{children:(0,a.jsx)("i",{className:"fas fa-cog"},void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:"dropdown-menu dropdown-menu-right"},{children:[(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:()=>{const e=`${blessing.base_url}/preview/${s.tid_skin}`,i=`${e}?png`,n=`${blessing.base_url}/preview/${s.tid_cape}`,t=`${n}?png`;(0,o.K)({mode:"alert",title:(0,l.t)("general.player.previews"),children:(0,a.jsxs)("div",Object.assign({className:"row"},{children:[(0,a.jsx)("div",Object.assign({className:"col-6 d-flex justify-content-center"},{children:s.tid_skin>0&&(0,a.jsx)("a",Object.assign({href:`${blessing.base_url}/skinlib/show/${s.tid_skin}`,target:"_blank"},{children:(0,a.jsxs)("picture",{children:[(0,a.jsx)("source",{srcSet:e,type:"image/webp"},void 0),(0,a.jsx)("img",{src:i,alt:`${s.name} - ${(0,l.t)("general.skin")}`,width:"128"},void 0)]},void 0)}),void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:"col-6 d-flex justify-content-center"},{children:s.tid_cape>0&&(0,a.jsx)("a",Object.assign({href:`${blessing.base_url}/skinlib/show/${s.tid_cape}`,target:"_blank"},{children:(0,a.jsxs)("picture",{children:[(0,a.jsx)("source",{srcSet:n,type:"image/webp"},void 0),(0,a.jsx)("img",{src:t,alt:`${s.name} - ${(0,l.t)("general.cape")}`,width:"128"},void 0)]},void 0)}),void 0)}),void 0)]}),void 0)})}},{children:[(0,a.jsx)("i",{className:"fas fa-eye mr-2"},void 0),(0,l.t)("general.player.previews")]}),void 0),(0,a.jsx)("div",{className:"dropdown-divider"},void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onUpdateName},{children:[(0,a.jsx)("i",{className:"fas fa-signature mr-2"},void 0),(0,l.t)("admin.changePlayerName")]}),void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onUpdateOwner},{children:[(0,a.jsx)("i",{className:"fas fa-user-edit mr-2"},void 0),(0,l.t)("admin.changeOwner")]}),void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item",onClick:e.onUpdateTexture},{children:[(0,a.jsx)("i",{className:"fas fa-tshirt mr-2"},void 0),(0,l.t)("admin.changeTexture")]}),void 0),(0,a.jsx)("div",{className:"dropdown-divider"},void 0),(0,a.jsxs)("a",Object.assign({href:"#",className:"dropdown-item dropdown-item-danger",onClick:e.onDelete},{children:[(0,a.jsx)("i",{className:"fas fa-trash mr-2"},void 0),(0,l.t)("admin.deletePlayer")]}),void 0)]}),void 0)]}),void 0)}),void 0)]}),void 0),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",Object.assign({className:"mr-2"},{children:["PID: ",s.pid]}),void 0),(0,a.jsxs)("span",{children:[(0,l.t)("general.player.owner"),": ",s.uid]},void 0)]},void 0),(0,a.jsx)("div",{children:(0,a.jsxs)("small",Object.assign({className:"text-gray"},{children:[`${(0,l.t)("general.player.last-modified")}: `,s.last_modified]}),void 0)},void 0)]},void 0)]}),void 0)]}),void 0)},b=i(1655);const u=(0,h.Z)(b.ZP)`
  width: ${e=>e.width};
`;var N=()=>(0,a.jsxs)(p,Object.assign({className:"info-box"},{children:[(0,a.jsx)("div",Object.assign({className:"info-box-icon"},{children:(0,a.jsx)(b.ZP,{circle:!0,height:50,width:50},void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:"info-box-content"},{children:[(0,a.jsxs)("div",Object.assign({className:"row"},{children:[(0,a.jsx)("div",Object.assign({className:"col-10"},{children:(0,a.jsx)(u,{width:"120px"},void 0)}),void 0),(0,a.jsx)("div",{className:"col-2"},void 0)]}),void 0),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:(0,a.jsx)(u,{width:"150px"},void 0)},void 0),(0,a.jsx)("div",{children:(0,a.jsx)(u,{width:"180px"},void 0)},void 0)]},void 0)]}),void 0)]}),void 0),f=i(3291),w=e=>{const{player:s}=e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:s.pid},void 0),(0,a.jsxs)("td",{children:[s.name,(0,a.jsx)("span",Object.assign({className:"ml-1"},{children:(0,a.jsx)(f.Z,{title:(0,l.t)("admin.changePlayerName"),onClick:e.onUpdateName},void 0)}),void 0)]},void 0),(0,a.jsxs)("td",{children:[s.uid,(0,a.jsx)("span",Object.assign({className:"ml-1"},{children:(0,a.jsx)(f.Z,{title:(0,l.t)("admin.changeOwner"),onClick:e.onUpdateOwner},void 0)}),void 0)]},void 0),(0,a.jsxs)("td",{children:[s.tid_skin>0&&(0,a.jsx)("a",Object.assign({href:`${blessing.base_url}/skinlib/show/${s.tid_skin}`,target:"_blank",className:"mr-1"},{children:(0,a.jsx)("img",{src:`${blessing.base_url}/preview/${s.tid_skin}`,alt:`${s.name} - ${(0,l.t)("general.skin")}`,width:"64"},void 0)}),void 0),s.tid_cape>0&&(0,a.jsx)("a",Object.assign({href:`${blessing.base_url}/skinlib/show/${s.tid_cape}`,target:"_blank"},{children:(0,a.jsx)("img",{src:`${blessing.base_url}/preview/${s.tid_cape}`,alt:`${s.name} - ${(0,l.t)("general.cape")}`,width:"64"},void 0)}),void 0)]},void 0),(0,a.jsx)("td",{children:s.last_modified},void 0),(0,a.jsxs)("td",Object.assign({className:"d-flex flex-wrap"},{children:[(0,a.jsx)("button",Object.assign({className:"btn btn-default mr-2",onClick:e.onUpdateTexture},{children:(0,l.t)("admin.changeTexture")}),void 0),(0,a.jsx)("button",Object.assign({className:"btn btn-danger",onClick:e.onDelete},{children:(0,l.t)("admin.deletePlayer")}),void 0)]}),void 0)]},void 0)};const y=(0,h.Z)(b.ZP)`
  line-height: 2;
`;var O=()=>(0,a.jsx)("tr",{children:(0,a.jsx)("td",Object.assign({colSpan:6},{children:(0,a.jsx)(y,{},void 0)}),void 0)},void 0),k=i(7109),_=i(7073),$=e=>{const[s,i]=(0,n.useState)("skin"),[t,d]=(0,n.useState)(""),r=e=>{i(e.target.value)};return(0,a.jsxs)(_.Z,Object.assign({show:e.open,center:!0,title:(0,l.t)("admin.changeTexture"),onConfirm:()=>{e.onSubmit(s,Number.parseInt(t)),i("skin"),d("")},onClose:()=>{i("skin"),d(""),e.onClose()}},{children:[(0,a.jsxs)("div",Object.assign({className:"form-group"},{children:[(0,a.jsx)("label",{children:(0,l.t)("admin.textureType")},void 0),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",Object.assign({className:"mr-5"},{children:[(0,a.jsx)("input",{className:"mr-1",type:"radio",value:"skin",checked:"skin"===s,onChange:r},void 0),(0,l.t)("general.skin")]}),void 0),(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{className:"mr-1",type:"radio",value:"cape",checked:s===k.N.Cape,onChange:r},void 0),(0,l.t)("general.cape")]},void 0)]},void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:"form-group"},{children:[(0,a.jsx)("label",Object.assign({htmlFor:"update-texture-tid"},{children:"TID"}),void 0),(0,a.jsx)("input",{type:"number",id:"update-texture-tid",className:"form-control",placeholder:(0,l.t)("admin.pidNotice"),value:t,onChange:e=>{d(e.target.value)}},void 0)]}),void 0)]}),void 0)},C=(0,t.w)((()=>{const[e,s]=(0,d.x)([]),[i,t]=(0,n.useState)(1),[h,x]=(0,n.useState)(1),[p,b]=(0,n.useState)(!1),u=(0,r.Z)(),[f,y]=(0,n.useState)(!1),[k,_]=(0,n.useState)(""),[C,Z]=(0,n.useState)(-1);(0,n.useLayoutEffect)((()=>{u&&y(!0)}),[u]);const S=async()=>{b(!0);const{data:e,last_page:a}=await c.U2(v.Z.admin.players.list(),{q:k,page:i});x(a),s((()=>e)),b(!1)};(0,n.useEffect)((()=>{S()}),[i]);const P=e=>{y("table"===e.target.value)},U=async(e,i)=>{let a;try{const{value:s}=await(0,o.K)({mode:"prompt",text:(0,l.t)("admin.changePlayerNameNotice"),input:e.name,validator:e=>{if(!e)return(0,l.t)("admin.emptyPlayerName")}});a=s}catch(e){return}const{code:n,message:t}=await c.gz(v.Z.admin.players.name(e.pid),{player_name:a});0===n?(o.A.success(t),s((e=>{e[i].name=a}))):o.A.error(t)},T=async(e,i)=>{let a;try{const{value:s}=await(0,o.K)({mode:"prompt",text:(0,l.t)("admin.changePlayerOwner"),input:e.uid.toString(),inputMode:"numeric"});a=Number.parseInt(s)}catch(e){return}const{code:n,message:t}=await c.gz(v.Z.admin.players.owner(e.pid),{uid:a});0===n?(o.A.success(t),s((e=>{e[i].uid=a}))):o.A.error(t)},A=async e=>{try{await(0,o.K)({text:(0,l.t)("admin.deletePlayerNotice"),okButtonType:"danger"})}catch(e){return}const{code:i,message:a}=await c.IV(v.Z.admin.players.delete(e.pid));0===i?(s((s=>s.filter((({pid:s})=>s!==e.pid)))),o.A.success(a)):o.A.error(a)};return(0,a.jsxs)("div",Object.assign({className:"card"},{children:[(0,a.jsxs)(m.Z,Object.assign({className:"card-header"},{children:[(0,a.jsxs)("form",Object.assign({className:"input-group",onSubmit:e=>{e.preventDefault(),S()}},{children:[(0,a.jsx)("input",{type:"text",inputMode:"search",className:"form-control",title:(0,l.t)("vendor.datatable.search"),value:k,onChange:e=>{_(e.target.value)}},void 0),(0,a.jsx)("div",Object.assign({className:"input-group-append"},{children:(0,a.jsx)("button",Object.assign({className:"btn btn-primary",type:"submit"},{children:(0,l.t)("vendor.datatable.search")}),void 0)}),void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:"btn-group btn-group-toggle"},{children:[(0,a.jsxs)("label",Object.assign({className:"btn btn-secondary "+(f?"active":""),title:"Table Mode"},{children:[(0,a.jsx)("input",{type:"radio",value:"table",checked:f,onChange:P},void 0),(0,a.jsx)("i",{className:"fas fa-list"},void 0)]}),void 0),(0,a.jsxs)("label",Object.assign({className:"btn btn-secondary "+(f?"":"active"),title:"Card Mode"},{children:[(0,a.jsx)("input",{type:"radio",value:"card",checked:!f,onChange:P},void 0),(0,a.jsx)("i",{className:"fas fa-grip-vertical"},void 0)]}),void 0)]}),void 0)]}),void 0),0!==e.length||p?f?(0,a.jsx)("div",Object.assign({className:"card-body table-responsive p-0"},{children:(0,a.jsxs)("table",Object.assign({className:"table "+(p?"":"table-striped")},{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"PID"},void 0),(0,a.jsx)("th",{children:(0,l.t)("general.player.player-name")},void 0),(0,a.jsx)("th",{children:(0,l.t)("general.player.owner")},void 0),(0,a.jsx)("th",{children:(0,l.t)("general.player.previews")},void 0),(0,a.jsx)("th",{children:(0,l.t)("general.player.last-modified")},void 0),(0,a.jsx)("th",{children:(0,l.t)("admin.operationsTitle")},void 0)]},void 0)},void 0),(0,a.jsx)("tbody",{children:p?new Array(10).fill(null).map(((e,s)=>(0,a.jsx)(O,{},s))):e.map(((e,s)=>(0,a.jsx)(w,{player:e,onUpdateName:()=>U(e,s),onUpdateOwner:()=>T(e,s),onUpdateTexture:()=>Z(s),onDelete:()=>A(e)},e.pid)))},void 0)]}),void 0)}),void 0):(0,a.jsx)("div",Object.assign({className:"card-body d-flex flex-wrap"},{children:p?new Array(10).fill(null).map(((e,s)=>(0,a.jsx)(N,{},s))):e.map(((e,s)=>(0,a.jsx)(g,{player:e,onUpdateName:()=>U(e,s),onUpdateOwner:()=>T(e,s),onUpdateTexture:()=>Z(s),onDelete:()=>A(e)},e.pid)))}),void 0):(0,a.jsx)("div",Object.assign({className:"card-body text-center"},{children:(0,l.t)("general.noResult")}),void 0),(0,a.jsx)("div",Object.assign({className:"card-footer"},{children:(0,a.jsx)("div",Object.assign({className:"float-right"},{children:(0,a.jsx)(j.Z,{page:i,totalPages:h,onChange:t},void 0)}),void 0)}),void 0),(0,a.jsx)($,{open:C>-1,onSubmit:async(i,a)=>{const{code:n,message:t}=await c.gz(v.Z.admin.players.texture(e[C].pid),{type:i,tid:a});0===n?(o.A.success(t),s((e=>{const s=`tid_${i}`;e[C][s]=a}))):o.A.error(t)},onClose:()=>Z(-1)},void 0)]}),void 0)}))}}]);